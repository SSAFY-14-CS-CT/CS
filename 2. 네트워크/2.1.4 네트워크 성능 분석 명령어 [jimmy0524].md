# 2.1.4 네트워크 성능 분석 명령어

## 네트워크 병목 현상의 주된 원인

- 네트워크 대역폭
- 네트워크 토폴로지
- 서버 CPU, 메모리 사용량
- 비효율적인 네트워크 구성

이러한 상황에서 네트워크 관련 테스트와 네트워크와 무관한 테스트를 통해 네트워크로부터 잘생한 문제점인 걸 확인한 후 성능 분석을 해봐야한다.

## ping

네트워크 상태를 확인하려는 대상 노드를 향해 일정 크기의 패킷을 전송하는 명령어이다.

- 해당 노드의 패킷 수신 상태와 도달하기까지 시간 등을 알 수 있다.
- TCP/IP 프로토콜 중에 ICMP 프로토콜을 통해 동작한다.
    - ICMP 프로토콜을 지원하지 않는 기기를 대상으로는 실행할 수 없다.
- 정책상  ICMP나 traceroute를 차단하는 경우 ping 테스팅은 불가능하다.

<img width="506" height="401" alt="image" src="https://github.com/user-attachments/assets/7745a175-7505-4128-8cb3-7e431e6a8848" />

- n 12 옵션을 넣어서 12번의 패킷을 보내고 12번의 패킷을 받는 모습

## netstat

접속되어 있는 서비스들의 네트워크 상태를 표시하는데 사용되며, 네트워크 접속, 라우팅 테이블, 네트워크 프로토콜 등 리스트를 보여준다. 주로 서비스의 포트가 열려 있는지 확인할 때 쓴다.

<img width="598" height="427" alt="image" src="https://github.com/user-attachments/assets/3a7f967f-e3e9-4066-b15a-2182cd0e30d0" />

### netstat State

| 상태 | 내용 |
| --- | --- |
| LISTEN | 연결 요구를 기다리는 상태. 포트가 열려있음 |
| ESTABLISHED | 서로 연결되어 있는 상태 |
| SVN_SENT | 클라이언트가 서버에 요구(SYN) 패킷을 보내고 연결을 요청한 상태 |
| SVN_RECV | 서버가 클라이언트로부터 접속 요구(SYN)을 받아 클라이언트에게 응답(SYN/ACK)하였지만, 아직 클라이언트에게 확인 메시지(ACK)는 받지 못한 상태 |
| FIN_WAIT1 | 클라이언트가 서버에게 연결을 끊고자 요청하는 상태 |
| FIN_WAIT2 | 서버가 클라이언트로부터 연결 종료 응답을 기다리는 상태 (서버가 클라이언트로부터 최초로 FIN을 받은 후, 클라이언트에게 ACK를 주었을 때) |
| TIME_WAIT | 이미 해당 사이트와 연결이 종료되었거나 다음 연결을 위해 기다리는 상태 |
| CLOSE_WAIT | TCP연결이 상위 응용프로그램 레벨로부터 연결 종료를 기다리는 상태 |
| LAST_ACK | 연결이 종료되었고 승인을 기다리는 상태 |
| CLOSED | 완전히 연결이 종료된 상태 |
| UNKNOWN | 소켓의 상테를 알 수 없음 |

### nslookup

dns에 관련된 내용을 확인하기 위해 쓰는 명령어이다. 특정 도메인에 매핑된 IP를 확인하기 위해 사용한다.

<img width="321" height="428" alt="image" src="https://github.com/user-attachments/assets/e9a86187-7b16-4992-9ab4-65ce4cc02dec" />

**❓ 왜 권한 없는 응답?**

DNS 서버가 해당 도메인에 대한 직접적인 권한이 없음을 나타냄  
캐시된 정보를 제공하는 건데, 이는 응답이 DNS 서버의 캐시에서 제공되었음을 의미한다.  
즉, 이전에 조회된 결과를 저장해두고 재사용한 것


### 권한 있는 응답 vs 권한 없는 응답

- 권한 있는 응답 : 해당 도메인의 공식 네임서버에서 직접 제공한 정보
- 권한 없는 응답 : 다른 DNS 서버로부터 받아 캐시된 정보

### tracert

윈도우 - tracert, 리눅스 - traceroute

목적지 노드까지 네트워크 경로를 확인할 때 사용하는 명령어로 목적지 노드까지 구간들 중 어느 구간에서 응답 시간이 느려지는지 확인 가능

<img width="560" height="426" alt="image" src="https://github.com/user-attachments/assets/890de80f-1e4a-4f72-84b0-03e33a89661e" />

<aside>

**❓ “요청 시간이 만료되었습니다” 뜨는 이유?**  

tracert는 목적지까지 가는 경유지(라우터)에 대해 ICMP 응답을 요청하지만,  
그 중 일부 라우터가 응답을 **차단하거나 무시**하면 "요청 시간이 만료되었습니다"로 표시된다.

</aside>