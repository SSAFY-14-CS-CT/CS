# 2.3.2 애플리케이션 계층을 처리하는 기기

### **1. L7 스위치 개요**

- **정의**: 스위치의 한 종류로, 네트워크 장비를 연결하고 목적지 포트로만 전기 신호를 보내 데이터 전송을 중재
- **별칭**: **로드밸런서**
- **주요 역할**:
    - 여러 서버에 트래픽을 분산하여 부하 분산
    - 응용 계층 정보(URL, HTTP 헤더, 쿠키 등)를 기반으로 라우팅
    - 바이러스 및 불필요한 데이터 필터링
    - 응용 프로그램 수준 트래픽 모니터링
    - 장애 서버를 자동 제외 (헬스 체크 기반)

---

### **2. L4 스위치 vs L7 스위치**

| 구분 | L4 스위치 | L7 스위치 |
| --- | --- | --- |
| **계층** | 전송 계층 | 애플리케이션 계층 |
| **기반** | IP 주소, 포트 | IP, 포트 + URL, HTTP 헤더, 쿠키 |
| **처리 방식** | 패킷의 전송 계층 정보만 분석 | 패킷의 응용 계층 내용까지 분석 가능 |
| **적용 예시** | NLB(Network Load Balancer, 클라우드) | ALB(Application Load Balancer, 클라우드) |
| **제약** | 스트리밍 서비스 등 메시지 기반 처리 불가 | 다양한 콘텐츠 기반 라우팅 가능 |

---

### **3. 헬스 체크 (Health Check)**

- **목적**: 정상/비정상 서버 판별
- **방식**:
    1. 주기적 요청 전송
    2. 응답 상태 코드, 지연 시간 등을 확인
    3. 비정상 서버는 로드밸런싱 대상에서 제외
- **설정 요소**:
    - 전송 주기
    - 재시도 횟수
    - 타임아웃

---

### **4. 로드밸런서를 이용한 서버 이중화**

- **구성**: 최소 2대 이상의 서버 + 로드밸런서
- **동작**:
    - 가상 IP(VIP) 제공 → 클라이언트는 단일 주소로 접속
    - 로드밸런서가 내부적으로 요청을 적절한 서버로 분산
- **장점**:
    - 장애 발생 시 자동 대체
    - 서비스 가용성 향상
    - 확장성 확보

---

💡 **정리 포인트**

- L4 → **전송 계층 기반 부하 분산** (IP, 포트)
- L7 → **애플리케이션 계층 기반 부하 분산** (URL, 헤더, 쿠키까지 분석)
- 둘 다 **헬스 체크**로 비정상 서버 제외 가능
- L7은 더 세밀한 트래픽 제어 가능하지만, 처리 부하와 지연이 더 클 수 있음